{"version":3,"file":"index.modern.js","sources":["../src/render/createElement.ts","../src/render/flattenChildren.ts","../src/render/havePropsChanged.ts","../src/render/minifyNode.ts","../src/paint/jobs/PaintJob.ts","../src/paint/getCanvas.ts","../src/paint/jobs/LayerJob.ts","../src/paint/jobs/LayerEndJob.ts","../src/paint/jobs/RectangleJob.ts","../src/paint/jobs/TextJob.ts","../src/paint/jobs/CircleJob.ts","../src/paint/jobs/PathJob.ts","../src/models/Hook.ts","../src/models/Point.ts","../src/models/Rect.ts","../src/models/Size.ts","../src/paint/jobs/PolygonJob.ts","../src/paint/jobs/FrameJob.ts","../src/paint/jobs/FrameEndJob.ts","../src/paint/jobs/GroupJob.ts","../src/paint/jobs/GroupEndJob.ts","../src/paint/buildPaintJobs.ts","../src/paint/paint.ts","../src/render/StateManager.ts","../src/render/Supervisor.ts","../src/PinkKoala.tsx","../src/hooks/haveArgsChanged.ts","../src/hooks/invokeOrReturn.ts","../src/hooks/getHookState.ts","../src/hooks/useEffect.ts","../src/hooks/useEventListener.ts","../src/hooks/useReducer.ts","../src/hooks/useState.ts","../src/hooks/useTicker.ts"],"sourcesContent":["import { AttributeCollection } from \"../models\"\nimport type { Node } from \"../models\"\n\nexport var Fragment = \"fragment\"\n\nexport function createNode(\n\ttype: string | Function,\n\tprops: AttributeCollection,\n\tchildren: Node[],\n\tneedsDraw: boolean = false\n): Node {\n\tlet node = createElement(type, props, ...children)\n\tnode.needsDraw = needsDraw\n\treturn node\n}\n\nexport function createElement(\n\ttype: string | Function,\n\tprops: AttributeCollection,\n\t...children: Node[]\n): Node {\n\tlet name: string = \"\"\n\tif (typeof type === \"string\") {\n\t\tname = type\n\t} else if (typeof type === \"function\") {\n\t\tname = type.name\n\t}\n\n\tif (name === \"text\" || name === \"string\") {\n\t\tif (children.length > 0) {\n\t\t\tprops.text = children.join(\" \")\n\t\t\tchildren = []\n\t\t}\n\t}\n\n\treturn {\n\t\ttype,\n\t\tname,\n\t\tprops: {\n\t\t\t...props,\n\t\t},\n\t\tchildren: children,\n\t\talternate: null,\n\t\thooks: [],\n\t\tneedsDraw: false,\n\t\tcache: null,\n\t}\n}\n","export function flattenChildren<T>(children: any[]): T[] {\n\tlet nodes: any[] = []\n\tif (Array.isArray(children)) {\n\t\tfor (let child of children) {\n\t\t\tif (Array.isArray(child)) {\n\t\t\t\tnodes = nodes.concat(flattenChildren(child))\n\t\t\t} else {\n\t\t\t\tnodes.push(child)\n\t\t\t}\n\t\t}\n\t}\n\treturn nodes\n}\n","import type { AttributeCollection } from \"../models\"\n\nexport function havePropsChanged(\n\ta: AttributeCollection,\n\tb: AttributeCollection\n) {\n\tconst ignoreKeys = [\"__source\", \"__self\"]\n\tif (a === null || b === null) {\n\t\treturn true\n\t}\n\tfor (let key in a) {\n\t\tif (ignoreKeys.indexOf(key) === -1) {\n\t\t\tif (Array.isArray(a[key])) {\n\t\t\t\tif (a[key].length !== b[key].length) {\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t\tfor (let i = 0; i < a[key].length; i++) {\n\t\t\t\t\tif (havePropsChanged(a[key][i], b[key][i])) {\n\t\t\t\t\t\treturn true\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (typeof a[key] === \"object\") {\n\t\t\t\tif (havePropsChanged(a[key], b[key])) {\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t} else if (a[key] !== b[key]) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\t}\n\n\treturn false\n}\n","import type { Node } from \"../models\"\n\nexport function minifyNode(node: Node): Node {\n\tlet mini = {\n\t\tname: node.name,\n\t\ttype: node.type,\n\t\tprops: node.props,\n\t\tchildren: node.children,\n\t\talternate: null,\n\t\thooks: node.hooks,\n\t\tneedsDraw: false,\n\t\tcache: node.cache,\n\t}\n\treturn pruneGrandChildren(mini)\n}\n\nexport function pruneGrandChildren(node: Node): Node {\n\tlet children = node.children.map(child => {\n\t\tlet mini = minifyNode(child)\n\t\tif (mini.children.length > 0) {\n\t\t\tmini.children = mini.children.map(grandChild => {\n\t\t\t\treturn minifyNode(grandChild)\n\t\t\t})\n\t\t}\n\t\treturn mini\n\t})\n\tnode.children = children\n\treturn node\n}\n","import { Node } from \"../../models\"\nimport type { AttributeCollection } from \"../../models/AttributeCollection\"\n\ntype PaintContext = {\n\tcanvas: HTMLCanvasElement | null\n\tcanvasStack: HTMLCanvasElement[]\n}\n\nlet paintContext: PaintContext = {\n\tcanvas: null,\n\tcanvasStack: [],\n}\n\nexport class PaintJob {\n\tpublic node: Node\n\n\tpublic name: string\n\n\tconstructor(node: Node) {\n\t\tthis.name = \"PaintJob\"\n\t\tthis.node = node\n\t}\n\n\tpublic doPainting() {\n\t\tthis.paint()\n\t}\n\n\tpublic paint() {}\n\n\tpublic get canvas(): HTMLCanvasElement | null {\n\t\treturn paintContext.canvas\n\t}\n\n\tpublic set canvas(val: HTMLCanvasElement | null) {\n\t\tpaintContext.canvas = val\n\t}\n\n\tpublic get paintingContext(): PaintContext {\n\t\treturn paintContext\n\t}\n\n\tpublic pushCanvas(canvas: HTMLCanvasElement) {\n\t\tpaintContext.canvasStack.push(canvas)\n\t}\n\n\tpublic popCanvas(): HTMLCanvasElement | null {\n\t\tlet c = paintContext.canvasStack.pop()\n\t\tif (c) {\n\t\t\treturn c\n\t\t} else {\n\t\t\treturn null\n\t\t}\n\t}\n\n\tpublic updateRenderingContextFromProps(\n\t\tctx: any,\n\t\tprops: AttributeCollection\n\t): PaintJobRenderingContextUpdate {\n\t\tlet hasChanged = false\n\t\tlet shouldFill = false\n\t\tlet shouldStroke = false\n\n\t\tconst map: AttributeCollection = {\n\t\t\tfill: \"fillStyle\",\n\t\t\tstroke: \"strokeStyle\",\n\t\t\tstrokeWidth: \"lineWidth\",\n\t\t\tfont: \"font\",\n\t\t}\n\n\t\tfor (let key in map) {\n\t\t\tlet ctxKey = map[key]\n\t\t\tif (props[key] && ctx[ctxKey] !== props[key]) {\n\t\t\t\tctx[ctxKey] = props[key]\n\t\t\t\thasChanged = true\n\t\t\t}\n\t\t\tif (key === \"fill\" && props[key]) {\n\t\t\t\tshouldFill = true\n\t\t\t}\n\t\t\tif (key === \"stroke\" && props[key]) {\n\t\t\t\tshouldStroke = true\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\thasChanged,\n\t\t\tshouldFill,\n\t\t\tshouldStroke,\n\t\t}\n\t}\n}\n\nexport interface PaintJobRenderingContextUpdate {\n\thasChanged: boolean\n\tshouldFill: boolean\n\tshouldStroke: boolean\n}\n","import { getSharedSupervisor } from \"../render/Supervisor\"\n\nexport function getCanvas(id: string): HTMLCanvasElement | undefined {\n    let sup = getSharedSupervisor()\n    const canvases = sup.canvases\n    const canvas = canvases.find((c) => c.id === id)\n    return canvas\n}\n","import { PaintJob } from \"./PaintJob\"\nimport { Node } from \"../../models\"\nimport { getCanvas } from \"../getCanvas\"\nlet canvasId = 0\n\nexport class LayerJob extends PaintJob {\n\tconstructor(node: Node) {\n\t\tsuper(node)\n\t\tthis.name = \"LayerJob\"\n\t}\n\n\tpublic paint() {\n\t\tlet canvas = getCanvas(this.node.props.id)\n\t\tif (canvas) {\n\t\t\tlet tmpCanvas = this.node.cache as HTMLCanvasElement | null\n\t\t\tif (!tmpCanvas) {\n\t\t\t\ttmpCanvas = document.createElement(\"canvas\")\n\t\t\t\ttmpCanvas.id = `tmp-layer-canvas-${canvasId++}`\n\t\t\t\ttmpCanvas.height = canvas.height\n\t\t\t\ttmpCanvas.width = canvas.width\n\t\t\t\tthis.node.cache = tmpCanvas\n\t\t\t}\n\t\t\tlet tmpContext = tmpCanvas.getContext(\"2d\")\n\t\t\tif (tmpContext) {\n\t\t\t\ttmpContext.clearRect(0, 0, tmpCanvas.width, tmpCanvas.height)\n\t\t\t\tthis.canvas = tmpCanvas\n\t\t\t}\n\t\t}\n\t}\n}\n","import { PaintJob } from \"./PaintJob\"\nimport { Node } from \"../../models\"\nimport { getCanvas } from \"../getCanvas\"\n\nexport class LayerEndJob extends PaintJob {\n\tconstructor(node: Node) {\n\t\tsuper(node)\n\t\tthis.name = \"LayerEndJob\"\n\t}\n\n\tpublic paint() {\n\t\tlet canvas = getCanvas(this.node.props.id)\n\t\tif (canvas) {\n\t\t\tlet origContext = canvas.getContext(\"2d\")!\n\t\t\torigContext.clearRect(0, 0, canvas.width, canvas.height)\n\t\t\torigContext.drawImage(this.node.cache, 0, 0)\n\n\t\t\t// reset the paint context canvas\n\t\t\tthis.canvas = canvas\n\t\t}\n\t}\n}\n","import { PaintJob } from \"./PaintJob\"\nimport { Node } from \"../../models\"\n\nexport class RectangleJob extends PaintJob {\n\tconstructor(node: Node) {\n\t\tsuper(node)\n\t\tthis.name = \"RectangleJob\"\n\t}\n\n\tpublic paint() {\n\t\t// parse attributes\n\t\tlet x = parseFloat(this.node.props.x as string) || 0\n\t\tlet y = parseFloat(this.node.props.y as string) || 0\n\t\tlet width = parseFloat(this.node.props.width as string) || 50\n\t\tlet height = parseFloat(this.node.props.height as string) || 50\n\n\t\t// get context\n\t\tif (this.canvas) {\n\t\t\tlet ctx = this.canvas.getContext(\"2d\")!\n\t\t\tlet cu = this.updateRenderingContextFromProps(ctx, this.node.props)\n\t\t\tif (cu.hasChanged) {\n\t\t\t\tctx.save()\n\t\t\t}\n\n\t\t\tctx.beginPath()\n\n\t\t\t// fill\n\t\t\tif (cu.shouldFill) {\n\t\t\t\tctx.fillRect(x, y, width, height)\n\t\t\t}\n\n\t\t\t// stroke\n\t\t\tif (cu.shouldStroke) {\n\t\t\t\tctx.strokeRect(x, y, width, height)\n\t\t\t}\n\n\t\t\tif (cu.hasChanged) {\n\t\t\t\tctx.restore()\n\t\t\t}\n\t\t}\n\t}\n}\n","import { PaintJob } from \"./PaintJob\"\nimport { Node } from \"../../models\"\n\nexport class TextJob extends PaintJob {\n\tconstructor(node: Node) {\n\t\tsuper(node)\n\t\tthis.name = \"TextJob\"\n\t}\n\n\tpublic paint() {\n\t\t// parse attributes\n\t\tlet x = parseFloat(this.node.props.x as string) || 0\n\t\tlet y = parseFloat(this.node.props.y as string) || 0\n\t\tlet text = (this.node.props.text as string) || \"Hello World\"\n\n\t\t// get context\n\t\tif (this.canvas) {\n\t\t\tlet ctx = this.canvas.getContext(\"2d\")!\n\t\t\tlet cu = this.updateRenderingContextFromProps(ctx, this.node.props)\n\t\t\tif (cu.hasChanged) {\n\t\t\t\tctx.save()\n\t\t\t}\n\n\t\t\tctx.beginPath()\n\t\t\tlet tm = ctx.measureText(text)\n\t\t\ty = y + tm.actualBoundingBoxAscent\n\n\t\t\t// fill\n\t\t\tif (cu.shouldFill) {\n\t\t\t\tctx.fillText(text, x, y)\n\t\t\t}\n\n\t\t\t// stroke\n\t\t\tif (cu.shouldStroke) {\n\t\t\t\tctx.strokeText(text, x, y)\n\t\t\t}\n\n\t\t\tif (cu.hasChanged) {\n\t\t\t\tctx.restore()\n\t\t\t}\n\t\t}\n\t}\n}\n","import { PaintJob } from \"./PaintJob\"\nimport { Node } from \"../../models\"\n\nexport class CircleJob extends PaintJob {\n\tconstructor(node: Node) {\n\t\tsuper(node)\n\t\tthis.name = \"CircleJob\"\n\t}\n\n\tpublic paint() {\n\t\t// parse attributes\n\t\tlet x = parseFloat(this.node.props.x as string) || 0\n\t\tlet y = parseFloat(this.node.props.y as string) || 0\n\t\tlet radius = 50\n\t\tif (this.node.props.radius) {\n\t\t\tradius = parseFloat(this.node.props.radius as string) || 50\n\t\t} else {\n\t\t\tradius = parseFloat(this.node.props.width as string) || 50\n\t\t\tradius = radius / 2\n\t\t}\n\n\t\t// get context\n\t\tif (this.canvas) {\n\t\t\tlet ctx = this.canvas.getContext(\"2d\")!\n\t\t\tlet cu = this.updateRenderingContextFromProps(ctx, this.node.props)\n\t\t\tif (cu.hasChanged) {\n\t\t\t\tctx.save()\n\t\t\t}\n\n\t\t\t// path\n\t\t\tctx.beginPath()\n\t\t\tctx.ellipse(\n\t\t\t\tx + radius,\n\t\t\t\ty + radius,\n\t\t\t\tradius,\n\t\t\t\tradius,\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\t2 * Math.PI\n\t\t\t)\n\n\t\t\t// fill\n\t\t\tif (cu.shouldFill) {\n\t\t\t\tctx.fill()\n\t\t\t}\n\n\t\t\t// stroke\n\t\t\tif (cu.shouldStroke) {\n\t\t\t\tctx.stroke()\n\t\t\t}\n\n\t\t\tif (cu.hasChanged) {\n\t\t\t\tctx.restore()\n\t\t\t}\n\t\t}\n\t}\n}\n","import { PaintJob } from \"./PaintJob\"\nimport { Node, Path } from \"../../models\"\n\nexport class PathJob extends PaintJob {\n\tconstructor(node: Node) {\n\t\tsuper(node)\n\t\tthis.name = \"PathJob\"\n\t}\n\n\tpublic paint() {\n\t\t// parse attributes\n\t\tlet closePath = this.node.props.closed ?? false\n\t\tlet path: Path = (this.node.props.path as Path) || []\n\n\t\t// get context\n\t\tif (this.canvas) {\n\t\t\tlet ctx = this.canvas.getContext(\"2d\")!\n\t\t\tlet cu = this.updateRenderingContextFromProps(ctx, this.node.props)\n\t\t\tif (cu.hasChanged) {\n\t\t\t\tctx.save()\n\t\t\t}\n\n\t\t\t// path\n\t\t\tctx.beginPath()\n\t\t\tlet i = 0\n\t\t\tfor (let pt of path) {\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tctx.moveTo(pt.x, pt.y)\n\t\t\t\t} else {\n\t\t\t\t\tctx.lineTo(pt.x, pt.y)\n\t\t\t\t}\n\t\t\t\ti++\n\t\t\t}\n\t\t\tif (closePath) {\n\t\t\t\tctx.closePath()\n\t\t\t}\n\n\t\t\t// fill\n\t\t\tif (cu.shouldFill) {\n\t\t\t\tctx.fill()\n\t\t\t}\n\n\t\t\t// stroke\n\t\t\tif (cu.shouldStroke) {\n\t\t\t\tctx.stroke()\n\t\t\t}\n\n\t\t\tif (cu.hasChanged) {\n\t\t\t\tctx.restore()\n\t\t\t}\n\t\t}\n\t}\n}\n","import type { Node } from \"./Node\"\n\nexport type EffectHookCallback = () => EffectHookCallback | null | void\nexport type TickHookCallback = (now: number, delta: number) => void\n\nexport type Hook = {\n\tstate: any\n\tqueue: any[]\n\tpendingEffects: EffectHookCallback[]\n\tpendingTicks: EffectHookCallback[]\n\tpendingUnmount: EffectHookCallback[]\n}\n\nexport function createHook(): Hook {\n\treturn {\n\t\tstate: {},\n\t\tqueue: [],\n\t\tpendingEffects: [],\n\t\tpendingTicks: [],\n\t\tpendingUnmount: [],\n\t}\n}\n","export type Point = {\n\tx: number\n\ty: number\n}\n\nexport function mkPoint(x: number, y: number): Point {\n\treturn { x, y }\n}\n\nexport function pointLerp(a: Point, b: Point, t: number): Point {\n\treturn mkPoint(a.x + (b.x - a.x) * t, a.y + (b.y - a.y) * t)\n}\n\nexport function pointAt(p: Point, angle: number, distance: number): Point {\n\treturn pointLerp(\n\t\tp,\n\t\tmkPoint(\n\t\t\tp.x + Math.cos(angle) * distance,\n\t\t\tp.y + Math.sin(angle) * distance\n\t\t),\n\t\t1\n\t)\n}\n","import type { Point } from \"./Point\"\nimport { mkPoint } from \"./Point\"\n\nexport type Rect = {\n    x: number\n    y: number\n    width: number\n    height: number\n}\n\nexport function mkRect(\n    x: number,\n    y: number,\n    width: number,\n    height: number\n): Rect {\n    return { x, y, width, height }\n}\n\nexport function rectLeft(rect: Rect): number {\n    return rect.x\n}\n\nexport function rectRight(rect: Rect): number {\n    return rect.x + rect.width\n}\n\nexport function rectTop(rect: Rect): number {\n    return rect.y\n}\n\nexport function rectBottom(rect: Rect): number {\n    return rect.y + rect.height\n}\n\nexport function rectCenter(rect: Rect): Point {\n    return mkPoint(rect.x + rect.width / 2, rect.y + rect.height / 2)\n}\n\nexport function rectContains(rect: Rect, point: Point): boolean {\n    return (\n        point.x >= rectLeft(rect) &&\n        point.x <= rectRight(rect) &&\n        point.y >= rectTop(rect) &&\n        point.y <= rectBottom(rect)\n    )\n}\n\nexport function rectIntersects(a: Rect, b: Rect): boolean {\n    return (\n        rectLeft(a) <= rectRight(b) &&\n        rectRight(a) >= rectLeft(b) &&\n        rectTop(a) <= rectBottom(b) &&\n        rectBottom(a) >= rectTop(b)\n    )\n}\n","export type Size = {\n\twidth: number\n\theight: number\n}\n\nexport const mkSize = (width: number, height: number): Size => ({\n\twidth,\n\theight,\n})\n","import { PaintJob } from \"./PaintJob\"\nimport { Node , Path, mkPoint, pointAt } from \"../../models\"\n\nexport class PolygonJob extends PaintJob {\n\tconstructor(node: Node) {\n\t\tsuper(node)\n\t\tthis.name = \"PolygonJob\"\n\t}\n\n\tpublic paint() {\n\t\t// parse attributes\n\t\tlet x = parseFloat(this.node.props.x as string) || 0\n\t\tlet y = parseFloat(this.node.props.y as string) || 0\n\t\tlet sides = parseFloat(this.node.props.sides as string) || 5\n\t\tlet radius = 50\n\t\tif (this.node.props.radius) {\n\t\t\tradius = parseFloat(this.node.props.radius as string) || 25\n\t\t} else {\n\t\t\tradius = parseFloat(this.node.props.width as string) || 50\n\t\t\tradius = radius / 2\n\t\t}\n\n\t\tlet center = mkPoint(x + radius, y + radius)\n\t\tlet angle = (Math.PI * 2) / sides\n\n\t\tlet path: Path = []\n\t\tfor (let i = 0; i < sides; i++) {\n\t\t\tlet pt = pointAt(center, angle * i, radius)\n\t\t\tpath.push(pt)\n\t\t}\n\n\t\t// get context\n\t\tif (this.canvas) {\n\t\t\tlet ctx = this.canvas.getContext(\"2d\")!\n\t\t\tlet cu = this.updateRenderingContextFromProps(ctx, this.node.props)\n\t\t\tif (cu.hasChanged) {\n\t\t\t\tctx.save()\n\t\t\t}\n\n\t\t\t// path\n\t\t\tctx.beginPath()\n\t\t\tlet i = 0\n\t\t\tfor (let pt of path) {\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tctx.moveTo(pt.x, pt.y)\n\t\t\t\t} else {\n\t\t\t\t\tctx.lineTo(pt.x, pt.y)\n\t\t\t\t}\n\t\t\t\tif (i === path.length - 1) {\n\t\t\t\t\tctx.closePath()\n\t\t\t\t}\n\t\t\t\ti++\n\t\t\t}\n\n\t\t\t// fill\n\t\t\tif (cu.shouldFill) {\n\t\t\t\tctx.fill()\n\t\t\t}\n\n\t\t\t// stroke\n\t\t\tif (cu.shouldStroke) {\n\t\t\t\tctx.stroke()\n\t\t\t}\n\n\t\t\tif (cu.hasChanged) {\n\t\t\t\tctx.restore()\n\t\t\t}\n\t\t}\n\t}\n}\n","import { PaintJob } from \"./PaintJob\"\nimport { Node } from \"../../models\"\n\nexport class FrameJob extends PaintJob {\n\tconstructor(node: Node) {\n\t\tsuper(node)\n\t\tthis.name = \"FrameJob\"\n\t}\n\n\tpublic paint() {\n\t\tconsole.log(\"Frame Job\", this.node)\n\t}\n}\n","import { PaintJob } from \"./PaintJob\"\nimport { Node } from \"../../models\"\n\nexport class FrameEndJob extends PaintJob {\n\tconstructor(node: Node) {\n\t\tsuper(node)\n\t\tthis.name = \"FrameEndJob\"\n\t}\n\n\tpublic paint() {\n\t\tconsole.log(\"FrameEnd Job\", this.node)\n\t}\n}\n","import { PaintJob } from \"./PaintJob\"\nimport { Node } from \"../../models\"\n\nlet groupId = 0\nexport class GroupJob extends PaintJob {\n\tconstructor(node: Node) {\n\t\tsuper(node)\n\t\tthis.name = \"GroupJob\"\n\t}\n\n\tpublic paint() {\n\t\tif (this.canvas) {\n\t\t\tthis.pushCanvas(this.canvas)\n\t\t\tlet tmpCanvas = this.node.cache as HTMLCanvasElement | null\n\t\t\tif (!tmpCanvas) {\n\t\t\t\ttmpCanvas = document.createElement(\"canvas\")\n\t\t\t\ttmpCanvas.id = `tmp-group-canvas-${groupId++}`\n\t\t\t\ttmpCanvas.height = this.canvas.height\n\t\t\t\ttmpCanvas.width = this.canvas.width\n\t\t\t\tthis.node.cache = tmpCanvas\n\t\t\t}\n\t\t\tlet tmpContext = tmpCanvas.getContext(\"2d\")\n\t\t\tif (tmpContext) {\n\t\t\t\ttmpContext.clearRect(0, 0, tmpCanvas.width, tmpCanvas.height)\n\t\t\t\tthis.canvas = tmpCanvas\n\t\t\t}\n\t\t}\n\t}\n}\n","import { PaintJob } from \"./PaintJob\"\nimport { Node } from \"../../models\"\n\nexport class GroupEndJob extends PaintJob {\n\tconstructor(node: Node) {\n\t\tsuper(node)\n\t\tthis.name = \"GroupEndJob\"\n\t}\n\n\tpublic paint() {\n\t\tif (this.node.needsDraw) {\n\t\t\tlet canvas = this.popCanvas()\n\t\t\tif (canvas) {\n\t\t\t\tlet origContext = canvas.getContext(\"2d\")!\n\t\t\t\torigContext.drawImage(this.node.cache, 0, 0)\n\n\t\t\t\t// reset the paint context canvas\n\t\t\t\tthis.canvas = canvas\n\t\t\t}\n\t\t} else {\n\t\t\tlet canvas = this.canvas\n\t\t\tif (canvas && this.node.cache) {\n\t\t\t\tlet ctx = canvas.getContext(\"2d\")\n\t\t\t\tctx?.drawImage(this.node.cache, 0, 0)\n\t\t\t}\n\t\t}\n\t}\n}\n","import {\n    PaintJob,\n    LayerJob,\n    LayerEndJob,\n    RectangleJob,\n    TextJob,\n    CircleJob,\n    PathJob,\n    PolygonJob,\n    FrameJob,\n    FrameEndJob,\n    GroupJob,\n    GroupEndJob\n} from \"./jobs\"\nimport { Node } from \"../models\"\n\nexport function buildPaintJobs(node: Node): PaintJob[] {\n    let jobs: PaintJob[] = []\n\n    if (node.needsDraw) {\n        // paint jobs\n        switch (node.name) {\n            case \"layer\":\n            case \"pklayer\":\n                jobs.push(new LayerJob(node))\n                break\n\n            case \"frame\":\n            case \"pkframe\":\n                jobs.push(new FrameJob(node))\n                break\n\n            case \"group\":\n            case \"pkgroup\":\n                jobs.push(new GroupJob(node))\n                break\n\n            case \"rect\":\n            case \"pkrect\":\n            case \"rectangle\":\n            case \"pkrectangle\":\n                jobs.push(new RectangleJob(node))\n                break\n\n            case \"string\":\n            case \"pkstring\":\n            case \"text\":\n            case \"pktext\":\n                jobs.push(new TextJob(node))\n                break\n\n            case \"circle\":\n            case \"pkcircle\":\n                jobs.push(new CircleJob(node))\n                break\n\n            case \"path\":\n            case \"pkpath\":\n                jobs.push(new PathJob(node))\n                break\n\n            case \"polygon\":\n            case \"pkpolygon\":\n                jobs.push(new PolygonJob(node))\n                break\n        }\n\n        // children jobs\n        for (let child of node.children) {\n            jobs = jobs.concat(buildPaintJobs(child))\n        }\n\n        // cleanup jobs\n        switch (node.name) {\n            case \"layer\":\n            case \"pklayer\":\n                jobs.push(new LayerEndJob(node))\n                break\n\n            case \"frame\":\n            case \"pkframe\":\n                jobs.push(new FrameEndJob(node))\n                break\n\n            case \"group\":\n            case \"pkgroup\":\n                jobs.push(new GroupEndJob(node))\n                break\n        }\n    } else {\n        // some items still need to draw from cache\n        switch (node.name) {\n            case \"group\":\n            case \"pkgroup\":\n                jobs.push(new GroupEndJob(node))\n                break\n        }\n    }\n\n    return jobs\n}\n","import { Node } from \"../models\"\nimport { PaintJob } from \"./jobs\"\nimport { buildPaintJobs } from \"./buildPaintJobs\"\n\nlet queue: PaintJob[] = []\n\nexport function paint(node: Node): void {\n\tif (queue.length === 0) {\n\t\tqueue = buildPaintJobs(node)\n\t\tpaintLoop()\n\t}\n}\n\nexport function paintLoop() {\n\tlet job: PaintJob | undefined | null = null\n\twhile (queue.length > 0) {\n\t\tjob = queue.shift()\n\t\tif (job) {\n\t\t\tjob.doPainting()\n\t\t}\n\t}\n}\n","import { Node } from \"../models\"\nimport type { AttributeCollection } from \"../models\"\nimport { flattenChildren } from \"./flattenChildren\"\nimport { havePropsChanged } from \"./havePropsChanged\"\nimport { minifyNode } from \"./minifyNode\"\nimport { paint } from \"../paint\"\n\ntype ChildrenDiff = {\n    children: Node[]\n    removed: Node[]\n}\n\nexport class StateManager {\n    public AUTO_LOOP = true\n\n    private paintCount = 0\n\n    public _root: Node | null = null\n\n    private _node: Node | null = null\n\n    public currentRoot: Node | null = null\n\n    public unitsOfWork: Node[] = []\n\n    public isRunning = false\n\n    public hasUpdateBeenRequested = false\n\n    public stepCallbackId: number | null = null\n\n    // for hooks\n    public hookIndex: number = 0\n\n    public get root(): Node | null {\n        return this._root\n    }\n\n    public get node(): Node | null {\n        return this._node\n    }\n\n    public set node(val: Node | null) {\n        this._node = val\n    }\n\n    public setRoot(fn: any) {\n        this._root = {\n            name: \"root\",\n            type: fn,\n            props: {},\n            children: [],\n            alternate: null,\n            hooks: [],\n            needsDraw: false,\n            cache: null\n        }\n        this.unitsOfWork.push(this._root)\n    }\n\n    constructor() {\n        this.step = this.step.bind(this)\n        if (this.AUTO_LOOP === false) {\n            const onKeyUp = (e: KeyboardEvent) => {\n                if (e.key === \" \") {\n                    //console.log(\"requestRootUpdate\")\n                    this.requestRootUpdate()\n                    let deadline = performance.now() + 16\n                    this.step({\n                        timeRemaining: () => deadline - performance.now(),\n                        didTimeout: false\n                    })\n                }\n            }\n            document.addEventListener(\"keyup\", onKeyUp)\n        }\n    }\n\n    public start() {\n        if (!this.isRunning) {\n            this.stepCallbackId = requestIdleCallback(this.step)\n            this.isRunning = true\n        }\n    }\n\n    public stop() {\n        this.isRunning = false\n        if (this.stepCallbackId) {\n            cancelIdleCallback(this.stepCallbackId)\n            this.stepCallbackId = null\n        }\n    }\n\n    public step(deadline: IdleDeadline) {\n        let start = performance.now()\n\n        // timer based hooks\n        if (this.currentRoot) {\n            this.workTimerHooks(this.currentRoot)\n        }\n\n        if (this.unitsOfWork.length === 0 && this.hasUpdateBeenRequested) {\n            this.startRootUpdate()\n        }\n\n        while (this.unitsOfWork.length > 0 && deadline.timeRemaining() > 2) {\n            this.performNextUnitOfWork()\n        }\n\n        if (this.unitsOfWork.length === 0) {\n            this.commitRoot()\n        }\n\n        if (this.unitsOfWork.length === 0 && this._root === null) {\n            if (this.currentRoot) {\n                this.workEffectHooks(this.currentRoot)\n            }\n        }\n\n        if (this.stepCallbackId) {\n            cancelIdleCallback(this.stepCallbackId)\n            this.stepCallbackId = null\n        }\n        if ((this.isRunning && this.AUTO_LOOP) || this.unitsOfWork.length > 0) {\n            this.stepCallbackId = requestIdleCallback(this.step)\n        }\n\n        let diff = performance.now() - start\n    }\n\n    public performNextUnitOfWork() {\n        let n = this.unitsOfWork.shift()\n        if (n) {\n            this._node = n\n        } else {\n            this._node = null\n        }\n        if (this._node) {\n            let next: Node[] = this.updateNode(this._node)\n            for (let n of next) {\n                this.unitsOfWork.push(n)\n            }\n        }\n    }\n\n    public commitRoot() {\n        this.currentRoot = this._root\n        this._root = null\n        //console.log(\"commitRoot\", this.currentRoot)\n        // TODO: hooks\n        // TODO: deletions\n        // TODO: paint\n        if (this.currentRoot) {\n            this.propigateNeedsDraw(this.currentRoot)\n            this.paintCount++\n            paint(this.currentRoot)\n        }\n    }\n\n    public requestRootUpdate() {\n        //console.log(\"requestRootUpdate\")\n        this.hasUpdateBeenRequested = true\n    }\n\n    public startRootUpdate() {\n        this.hasUpdateBeenRequested = false\n        //console.log(\"startRootUpdate\")\n        if (this.currentRoot) {\n            this._root = {\n                name: \"root\",\n                type: this.currentRoot.type,\n                props: this.currentRoot.props,\n                children: this.currentRoot.children,\n                alternate: minifyNode(this.currentRoot),\n                hooks: this.currentRoot.hooks,\n                needsDraw: false,\n                cache: null\n            }\n        }\n        if (this._root) {\n            this.unitsOfWork = [this._root]\n        }\n    }\n\n    workTimerHooks(node: Node) {\n        // children\n        for (let child of node.children) {\n            this.workTimerHooks(child)\n        }\n\n        for (let hook of node.hooks) {\n            for (let action of hook.pendingTicks) {\n                action()\n            }\n            hook.pendingTicks = []\n        }\n    }\n\n    workEffectHooks(node: Node) {\n        // children\n        for (let child of node.children) {\n            this.workEffectHooks(child)\n        }\n\n        for (let hook of node.hooks) {\n            for (let action of hook.pendingEffects) {\n                let unmount = hook.queue.pop()\n                if (unmount) {\n                    unmount()\n                }\n                let cb = action()\n                if (cb) {\n                    hook.queue.push(cb)\n                }\n            }\n            hook.pendingEffects = []\n        }\n    }\n\n    workUmountHooks(node: Node) {\n        // children\n        for (let child of node.children) {\n            this.workEffectHooks(child)\n        }\n\n        for (let hook of node.hooks) {\n            for (let action of hook.pendingUnmount) {\n                action()\n            }\n            hook.pendingUnmount = []\n        }\n    }\n\n    public updateNode(node: Node): Node[] {\n        if (!node.alternate) {\n            node.needsDraw = true\n        }\n        let prevChildren: Node[] = []\n        if (node.type instanceof Function) {\n            this.hookIndex = 0\n            node.hooks = []\n            prevChildren = node.children\n            let f = node.type as (props: AttributeCollection) => Node\n\n            node.children = [f(node.props)]\n        } else {\n            prevChildren = node.alternate ? node.alternate.children : []\n        }\n\n        //// Optimization for groups\n        // if (node.name === \"group\") {\n        // \tlet nextChildren: Node[] = flattenChildren(node.children)\n        // \tif (node.needsDraw === true) {\n        // \t\tlet childDiff = this.diffChildren(nextChildren, prevChildren)\n        // \t\tnode.children = childDiff.children\n        // \t} else {\n        // \t\tnode.children = nextChildren.map(c => {\n        // \t\t\tc.needsDraw = false\n        // \t\t\treturn c\n        // \t\t})\n        // \t}\n        // } else {\n        // \tlet nextChildren: Node[] = flattenChildren(node.children)\n        // \tlet childDiff = this.diffChildren(nextChildren, prevChildren)\n        // \tnode.children = childDiff.children\n        // }\n        let nextChildren: Node[] = flattenChildren(node.children)\n        let childDiff = this.diffChildren(nextChildren, prevChildren)\n        node.children = childDiff.children\n\n        // TODO: handle removed children\n\n        return node.children\n    }\n\n    public propigateNeedsDraw(\n        parent: Node,\n        inherited: boolean = false\n    ): boolean {\n        let needsDraw =\n            parent.needsDraw ||\n            (inherited &&\n                ![\"pklayer\", \"layer\", \"group\", \"pkgroup\"].includes(parent.name))\n        // propigate up\n        for (let child of parent.children) {\n            needsDraw = needsDraw || this.propigateNeedsDraw(child, needsDraw)\n        }\n        // propigate down to all children\n        if (needsDraw) {\n            for (let child of parent.children) {\n                this.propigateNeedsDraw(child, true)\n            }\n        }\n        parent.needsDraw = needsDraw\n        return needsDraw\n    }\n\n    public diffChildren(\n        nextChildren: Node[],\n        prevChildren: Node[]\n    ): ChildrenDiff {\n        let children: Node[] = []\n        let removed: Node[] = []\n        let length = Math.max(nextChildren.length, prevChildren.length)\n\n        for (let i = 0; i < length; i++) {\n            let next = nextChildren[i]\n            let prev = prevChildren[i]\n            let nextNode = this.diffNode(next, prev)\n            if (nextNode) {\n                children.push(nextNode)\n            }\n            if (prev) {\n                if (!nextNode) {\n                    removed.push(prev)\n                }\n            }\n        }\n\n        return { children, removed }\n    }\n\n    public diffNode(a: Node | null, b: Node | null): Node | null {\n        let next: Node | null = null\n        let sameType = false\n        if (a && b) {\n            sameType = a.type === b.type\n        }\n\n        if (a && b && sameType) {\n            let needsDraw = false\n            if (havePropsChanged(a.props, b.props)) {\n                needsDraw = true\n            }\n            next = {\n                name: a.name,\n                type: a.type,\n                props: a.props,\n                children: a.children,\n                needsDraw: needsDraw,\n                hooks: b.hooks,\n                cache: b.cache,\n                alternate: minifyNode(b)\n            }\n        } else if (a && !sameType) {\n            next = {\n                name: a.name,\n                type: a.type,\n                props: a.props,\n                children: a.children,\n                alternate: null,\n                needsDraw: true,\n                hooks: [],\n                cache: null\n            }\n        } else {\n            //console.error(\"diffNode\", a, b, sameType)\n        }\n\n        return next\n    }\n}\n","import { StateManager } from \"./StateManager\"\n\nexport type Layer = {\n    child: any\n    canvases: any[]\n}\n\nexport class Supervisor {\n    public stateManager: StateManager\n\n    public canvases: HTMLCanvasElement[] = []\n\n    constructor() {\n        this.stateManager = new StateManager()\n    }\n\n    addLayer(layer: Layer) {\n        this.stateManager.setRoot(layer.child)\n        this.canvases = layer.canvases\n    }\n\n    public get currentContext(): StateManager | null {\n        return this.stateManager\n    }\n\n    public get activeLayer(): StateManager | null {\n        return this.stateManager\n    }\n\n    public start(): void {\n        this.activeLayer?.start()\n    }\n\n    public stop(): void {}\n}\n\nlet sharedSupervisor: Supervisor = new Supervisor()\nexport function getSharedSupervisor(): Supervisor {\n    return sharedSupervisor\n}\n","import React, { useRef, useEffect } from \"react\"\nimport type { Size, AttributeCollection } from \"./models/\"\nimport { getSharedSupervisor } from \"./render\"\nimport \"./PinkKoala.css\"\n\nexport type PinkKoalaProps = {\n    drawing: any\n    drawingProps: AttributeCollection | null\n    layers: string[]\n    size: Size\n}\n\nexport const PinkKoala = (props: PinkKoalaProps) => {\n    let containerRef = useRef<HTMLDivElement>(null)\n\n    useEffect(() => {\n        if (containerRef.current) {\n            const canvasNodes = containerRef.current.querySelectorAll(\"canvas\")\n            let canvases = Array.from(canvasNodes).map((node) => {\n                return node as HTMLCanvasElement\n            })\n\n            getSharedSupervisor().addLayer({\n                child: props.drawing,\n                canvases: canvases\n            })\n            getSharedSupervisor().start()\n        }\n    }, [props.drawing, containerRef])\n\n    return (\n        <div ref={containerRef} className=\"PinkKoala\">\n            {props.layers.map((layer) => (\n                <canvas\n                    key={layer}\n                    id={layer}\n                    width={props.size.width}\n                    height={props.size.height}\n                />\n            ))}\n        </div>\n    )\n}\n","export function haveArgsChanged(a: any[], b: any[]) {\n\tif (!a && !b) {\n\t\treturn false\n\t}\n\tif ((!a && b) || (!b && a)) {\n\t\t//console.log(\"args changed nulls\", a, b)\n\t\treturn true\n\t}\n\tif (a.length !== b.length) {\n\t\t//console.log(\"args changed length\", a, b)\n\t\treturn true\n\t}\n\tfor (let i = 0; i < a.length; i++) {\n\t\tif (a[i] !== b[i]) {\n\t\t\t//console.log(\"args changed value\", a, b)\n\t\t\treturn true\n\t\t}\n\t}\n\t//console.log(\"args not chagned\", a, b)\n\treturn false\n}\n","export function invokeOrReturn(arg: any, f: any): any {\n\treturn typeof f == \"function\" ? f(arg) : f\n}\n","import type { Hook } from \"../models\"\nimport { StateManager } from \"../render/StateManager\"\nimport { getSharedSupervisor } from \"../render/Supervisor\"\n\ntype HookState = {\n\tcontext: StateManager | null\n\tprevHook: Hook | null\n}\n\nexport function getHookState(): HookState {\n\tlet hook: Hook | null = null\n\tlet context: StateManager | null = getSharedSupervisor().currentContext\n\n\tif (context) {\n\t\tif (context.node) {\n\t\t\thook =\n\t\t\t\tcontext.node.alternate &&\n\t\t\t\tcontext.node.alternate.hooks &&\n\t\t\t\tcontext.node.alternate.hooks[context.hookIndex]\n\t\t}\n\t}\n\n\treturn {\n\t\tcontext,\n\t\tprevHook: hook,\n\t}\n}\n","import type { EffectHookCallback } from \"../models\"\nimport { createHook } from \"../models\"\nimport { getHookState } from \"./getHookState\"\nimport { haveArgsChanged } from \"./haveArgsChanged\"\n\nexport function useEffect(callback: EffectHookCallback, args: any[]) {\n\tlet hookState = getHookState()\n\tlet prevHook = hookState.prevHook\n\tlet context = hookState.context\n\n\tif (!context || !context.node) {\n\t\tthrow new Error(\n\t\t\t\"useReducer must be called from within a render function\"\n\t\t)\n\t}\n\n\tlet hook = createHook()\n\tif (prevHook) {\n\t\thook.state = prevHook.state\n\t\thook.queue = prevHook.queue\n\t}\n\n\tif (haveArgsChanged(args, prevHook?.state)) {\n\t\thook.pendingEffects.push(callback)\n\t\thook.state = args\n\t}\n\tcontext.node.hooks.push(hook)\n\tcontext.hookIndex++\n}\n","import { useEffect } from \"./useEffect\"\n\nexport function useEventListener(event: string, handler: any, args: any[]) {\n\tuseEffect(() => {\n\t\tdocument.addEventListener(event, handler)\n\t\treturn () => {\n\t\t\tdocument.removeEventListener(event, handler)\n\t\t}\n\t}, [...args, event, handler])\n}\n","import { createHook } from \"../models\"\nimport { getHookState } from \"./getHookState\"\nimport { invokeOrReturn } from \"./invokeOrReturn\"\n\ntype ReducerCallback = (state: any, action: any) => any\n\nexport function useReducer(\n\treducer: any,\n\tinitialState: any,\n\tinit: any = null\n): any[] {\n\tlet hookState = getHookState()\n\tlet prevHook = hookState.prevHook\n\tlet context = hookState.context\n\n\tif (!context || !context.node) {\n\t\tthrow new Error(\n\t\t\t\"useReducer must be called from within a render function\"\n\t\t)\n\t}\n\n\tlet hook = createHook()\n\tif (init) {\n\t\thook.state = init(initialState)\n\t} else {\n\t\thook.state = prevHook\n\t\t\t? prevHook.state\n\t\t\t: invokeOrReturn(undefined, initialState)\n\t}\n\n\tconst actions = prevHook ? prevHook.queue : []\n\tactions.forEach(action => {\n\t\thook.state = reducer(hook.state, action)\n\t})\n\tif (prevHook) {\n\t\tprevHook.queue = []\n\t}\n\n\tconst dispatch = (action: any) => {\n\t\thook.queue.push(action)\n\t\tcontext?.requestRootUpdate()\n\t}\n\n\tcontext.node!.hooks.push(hook)\n\tcontext.hookIndex++\n\treturn [hook.state, dispatch]\n}\n","import { useReducer } from \"./useReducer\"\nimport { createHook } from \"../models\"\nimport { getHookState } from \"./getHookState\"\nimport { invokeOrReturn } from \"./invokeOrReturn\"\n\nexport function useState(initialState: any): any[] {\n\treturn useReducer(invokeOrReturn, initialState)\n}\n","import { getHookState } from \"./getHookState\"\nimport { createHook } from \"../models\"\nimport type { EffectHookCallback, TickHookCallback } from \"../models\"\n\nexport function useTicker(callback: TickHookCallback) {\n\tlet hookState = getHookState()\n\tlet prevHook = hookState.prevHook\n\tlet context = hookState.context\n\n\tif (!context || !context.node) {\n\t\tthrow new Error(\n\t\t\t\"useTicker must be called from within a render function\"\n\t\t)\n\t}\n\n\tconst hook = createHook()\n\thook.state = prevHook ? prevHook.state : { now: -1, delta: -1 }\n\n\tconst onTick = (): EffectHookCallback | null => {\n\t\tlet now = Date.now()\n\t\tlet delta = -1\n\t\tif (prevHook && prevHook.state.lastTick > 0) {\n\t\t\tdelta = now - prevHook.state.lastTick\n\t\t}\n\t\thook.state = { lastTick: now, delta }\n\t\tcallback(now, delta)\n\t\treturn null\n\t}\n\thook.pendingTicks.push(onTick)\n\n\tcontext.node.hooks.push(hook)\n\tcontext.hookIndex++\n}\n"],"names":["Fragment","createElement","type","props","children","name","length","text","join","alternate","hooks","needsDraw","cache","flattenChildren","nodes","Array","isArray","child","concat","push","havePropsChanged","a","b","ignoreKeys","key","indexOf","i","minifyNode","node","mini","pruneGrandChildren","map","grandChild","paintContext","canvas","canvasStack","PaintJob","doPainting","paint","pushCanvas","popCanvas","c","pop","updateRenderingContextFromProps","ctx","hasChanged","shouldFill","shouldStroke","fill","stroke","strokeWidth","font","ctxKey","val","getCanvas","id","sup","getSharedSupervisor","canvases","find","canvasId","LayerJob","tmpCanvas","document","height","width","tmpContext","getContext","clearRect","LayerEndJob","origContext","drawImage","RectangleJob","x","parseFloat","y","cu","save","beginPath","fillRect","strokeRect","restore","TextJob","tm","measureText","actualBoundingBoxAscent","fillText","strokeText","CircleJob","radius","ellipse","Math","PI","PathJob","closePath","closed","path","pt","moveTo","lineTo","createHook","state","queue","pendingEffects","pendingTicks","pendingUnmount","mkPoint","pointLerp","t","pointAt","p","angle","distance","cos","sin","mkRect","rectLeft","rect","rectRight","rectTop","rectBottom","rectCenter","rectContains","point","rectIntersects","mkSize","PolygonJob","sides","center","FrameJob","console","log","FrameEndJob","groupId","GroupJob","GroupEndJob","buildPaintJobs","jobs","paintLoop","job","shift","StateManager","step","bind","AUTO_LOOP","onKeyUp","e","requestRootUpdate","deadline","performance","now","timeRemaining","didTimeout","addEventListener","setRoot","fn","_root","unitsOfWork","start","isRunning","stepCallbackId","requestIdleCallback","stop","cancelIdleCallback","currentRoot","workTimerHooks","hasUpdateBeenRequested","startRootUpdate","performNextUnitOfWork","commitRoot","workEffectHooks","diff","n","_node","next","updateNode","propigateNeedsDraw","paintCount","hook","action","unmount","cb","workUmountHooks","prevChildren","Function","hookIndex","f","nextChildren","childDiff","diffChildren","parent","inherited","includes","removed","max","prev","nextNode","diffNode","sameType","Supervisor","stateManager","addLayer","layer","activeLayer","sharedSupervisor","PinkKoala","containerRef","useRef","useEffect","current","canvasNodes","querySelectorAll","from","drawing","React","ref","className","layers","size","haveArgsChanged","invokeOrReturn","arg","getHookState","context","currentContext","prevHook","callback","args","hookState","Error","useEventListener","event","handler","removeEventListener","useReducer","reducer","initialState","init","undefined","actions","forEach","dispatch","useState","useTicker","delta","onTick","Date","lastTick"],"mappings":"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"}